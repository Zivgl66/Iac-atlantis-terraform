version: 3
automerge: true
projects:
  - name: infrastructure-gitops
    branch: /main/
    dir: .
    autoplan:
      when_modified: ["*.tf", "*.tfvars", "*.tfstate"]
    apply_requirements: [approved]
workflows:
  default:
    plan:
      steps:
        - init
        - plan
    apply:
      steps:
        - apply
